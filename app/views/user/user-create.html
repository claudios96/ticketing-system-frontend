<div>
    <div class="row">
        <div class="col-lg-12">
            <h1 class="page-header">Inserisci Un Nuovo Utente</h1>
        </div>
        <!-- /.col-lg-12 -->
    </div>
    <!-- /.row -->
    <div class="row">
        <div class="col-lg-12">
            <div class="panel panel-primary">
                <div class="panel-heading">Inserisci Dati</div>
                <div class="panel-body">
                    <form name="formCreateUser">
                        <div class="row">
                            <div class="col-lg-6">
                                <div class="form-group" ng-class="{'has-success': ctrl.currentUser.username}">
                                    <label>Username</label>
                                    <input class="form-control" placeholder="Inserisci un username"
                                           ng-model="ctrl.currentUser.username" required>
                                </div>
                            </div>
                            <div class="col-lg-6">
                                <div class="form-group" ng-class="{'has-success': ctrl.currentUser.password}">
                                    <label>Password</label>
                                    <input type="password" class="form-control" placeholder="Inserisci una Password"
                                           ng-model="ctrl.currentUser.password" required>
                                </div>
                            </div>
                        </div>

                        <div class="row">
                            <div class="col-lg-6">
                                <div class="form-group" ng-class="{'has-success': ctrl.currentUser.firstName}">
                                    <label>Nome</label>
                                    <input class="form-control" placeholder="Inserisci nome"
                                           ng-model="ctrl.currentUser.firstName" required>
                                </div>
                            </div>

                            <div class="col-lg-6">
                                <div class="form-group" ng-class="{'has-success': ctrl.currentUser.lastName}">
                                    <label>Cognome</label>
                                    <input class="form-control" placeholder="Inserisci cognome"
                                           ng-model="ctrl.currentUser.lastName" required>
                                </div>
                            </div>
                        </div>

                        <div class="row">
                            <div class="col-lg-6">
                                <div class="form-group"
                                     ng-class="{'has-success': ctrl.currentUser.email && formCreateUser.email.$valid , 'has-error': formCreateUser.email.$touched && formCreateUser.email.$invalid}">
                                    <label>E-Mail</label>
                                    <input type="email" name="email" class="form-control"
                                           placeholder="Inserisci un'email valida (es. esempio@email.com)"
                                           ng-model="ctrl.currentUser.email"
                                           ng-pattern="/^[\w-]+(\.[\w-]+)*@([a-z0-9-]+(\.[a-z0-9-]+)*?\.[a-z]{2,6}|(\d{1,3}\.){3}\d{1,3})(:\d{4})?$/"
                                           required>
                                    <p><label ng-show="formCreateUser.email.$touched && formCreateUser.email.$invalid"
                                              style="color: #A94442">Inserire una mail valida.</label></p>

                                </div>
                            </div>
                            <div class="col-lg-6">
                                <div class="form-group" ng-class="{'has-success': ctrl.currentUser.role}">
                                    <label>Ruolo</label>

                                    <ui-select ng-model="ctrl.currentUser.role">
                                        <ui-select-match allow-clear="false" placeholder="Seleziona tipologia utente">
                                            {{$select.selected}}
                                        </ui-select-match>
                                        <ui-select-choices repeat='role in ctrl.rolesList | filter: $select.search' value="{{$select.selected}}}">
                                            <span ng-bind="role | highlight: $select.search"></span>
                                        </ui-select-choices>
                                    </ui-select>
                                </div>
                            </div>
                        </div>

                        <div class = "row">
                            <div class="col-lg-6">
                                <div class="form-group" ng-class="{'has-success': ctrl.currentUser.company }">
                                    <label>Company</label>

                                    <ui-select ng-model="ctrl.currentUser.company">
                                        <ui-select-match allow-clear="false" placeholder="Seleziona company">
                                            {{$select.selected.name}}
                                        </ui-select-match>
                                        <ui-select-choices repeat='company.id as company in ctrl.companies | filter: $select.search' value="{{$select.selected.id}}}">
                                            <span ng-bind="company.name | highlight: $select.search"></span>
                                        </ui-select-choices>
                                    </ui-select>
                                </div>
                            </div>
                            <div class="col-lg-6">
                                <div class="form-group" ng-class="{'has-success': ctrl.currentUser.slackAccount}">
                                    <label>Slack id</label>
                                    <input class="form-control" placeholder="Inserisci id account slack (opzionale)"
                                           ng-model="ctrl.currentUser.slackAccount">
                                </div>
                            </div>

                        </div>
                    </form>
                    <div class="row">
                        <div class="col-lg-6">
                            <div class="form-group">
                                <button class="btn btn-primary"
                                        ng-disabled="!(!formCreateUser.$invalid && hasPermission('user_create'))"
                                        ng-click="ctrl.insertUser()">Inserisci Utente
                                </button>
                                <button class="btn btn-danger" ng-click="ctrl.resetFields()">Reset</button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <!-- /.panel -->
        </div>
        <!-- /.col-lg-12 -->
    </div>

    <div ng-if="isDebug">{{ctrl.currentUser}}</div>

</div>